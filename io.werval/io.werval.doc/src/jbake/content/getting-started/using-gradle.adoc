
[TIP]
.TL;DR
====
["source",subs="callouts"]
----
git archive --format=tar --prefix=werval-gradle/ --remote=git@github.com:werval/werval-skel-gradle.git master | tar -xf - <1>
cd werval-gradle
gradle devshell <2>
----
<1> Create a new application
<2> Run in development mode
====


== Create a new application

To create a new Werval application based on Gradle, use the following command:

[source,bash]
----
git archive --format=tar --prefix=YOUR_APP_NAME/ --remote=git@github.com:werval/werval-skel-gradle.git master | tar -xf -
----

Where `YOUR_APP_NAME` is, well, your application name.
A directory with this name will be created with the new application in it.

[IMPORTANT]
.What is this horrible command?
====
What the 'horrible' command above does is to export the content of a git repository at a given reference to a directory
of your choice without creating a clone.
In other words, it simply downloads the content of a git repository at a given reference.

A command line client for easy usage of application skeletons is under active discussion, planned and will be added in
a future release.

For the time being, you'll have to copy/paste/edit, or type, this horrible command :)
====


== Run in development mode

To run a Werval application in development mode, use the `devshell` Gradle task:

[source]
----
gradle devshell
----

Your default browser should have opened http://localhost:23023/ showing the following welcome page:

image::images/welcome.png[Welcome,640]

As stated on the welcome page above, when running the Development Shell, the whole Werval documentation is available right from the HTTP server that run your application. Open http://localhost:23023/@doc to browse the documentation. This very article should be available at http://localhost:23023/@doc/getting-started.html but maybe you are already reading it from there.

// If you want to change the listening address and port override `werval.http.address` and `werval.http.port` either
// through the command line by adding `-Dwerval.http.address=0.0.0.0` and `-Dwerval.http.port=80` for example ; or in the
// `application.conf` file.

[TIP]
====
In production mode, you need an application's secret.
This secret is a key used for cypher and signature operations, it must be unique per application.
Its place is in the application configuration, see `./src/main/resources/application.conf`.
One can generate a new random secret using the `secret` Gradle task:

    gradle secret

It is easily appended to the `application.conf` file this way:

    gradle -q secret >> ./src/main/resources/application.conf

Once you have properly set your application's secret, use the `start` Gradle task to run your application in production mode:

    gradle start
====


== Application Walkthrough

The newly created application has a single HTTP route:

.`./src/main/resources/routes.conf`
[source,routes]
----
GET / controllers.Application.index
----

That points to this controller method:

.`./src/main/java/controllers/Application.java`
[source,java]
----
public Outcome index()
{
    return outcomes().ok( "It Works!" ).build();
}
----

Here is the project tree:

    ├── src
    │   └── main
    │       ├── java
    │       │   └── controllers
    │       │       └── Application.java            <= Controller Java Class
    │       └── resources
    │           ├── application.conf                <= Application Configuration
    │           └── routes.conf                     <= Routes
    │
    └── build.gradle                                <= Gradle build file

You can see that applications generated by `werval` follow the well known maven directory tree convention.
Yes, it could have simplified things a bit to simply use `src`, `app` or `conf` directory names but this way it's
damn easy to add a Gradle or Maven build to such an application.

At the bottom of the tree you can see the Gradle build file.
Here is what you'll find inside:

.`./build.gradle`
["source","groovy",subs="attributes,callouts"]
----
buildscript {
	repositories { maven { url 'https://repo.codeartisans.org/werval' } }    // <1>
	dependencies { classpath 'io.werval:io.werval.gradle:{werval_version}' } // <2>
}

apply plugin: 'io.werval.application'       // <3>
----
<1> Declare Werval repository for the build
<2> Add Werval Gradle Plugin to build classpath
<3> Apply the Werval Gradle plugin

TIP: See the link:guides.html#gradle_plugin[Werval Gradle Plugin guide] for more insights.
