// QiWeb Documentation

buildscript {
    repositories {
        mavenRepo name: 'Bintray Asciidoctor repo', url: 'http://dl.bintray.com/content/aalmiray/asciidoctor'
        mavenRepo name: 'Bintray JCenter', url: 'http://jcenter.bintray.com'
    }
    dependencies {
        classpath 'org.asciidoctor:asciidoctor-gradle-plugin:0.5.0'
    }
}

apply plugin: 'asciidoctor'

task copyAssets( type: Copy ) {
    from 'src/assets'
    into 'build/asciidoc'
}

asciidoctor {
    sourceDir = file( "src/asciidoc" )
    outputDir = file( "build/asciidoc" )
    backend = 'html5'
    options = [
        compact: true,
        attributes: [
            'qiweb-version': version,
            'toc2': '',
            'stylesheet': 'stylesheets/foundation.css',
            'docinfo1': '',
        ]
    ]
    logDocuments = true
}

asciidoctor.dependsOn( copyAssets )

task docResources( type: Copy, dependsOn: [ asciidoctor, genVersionClass ] ) {
    from 'build/asciidoc'
    into 'build/classes/main/org/qiweb/doc/html'
}

compileJava.dependsOn( docResources )
